load demo_data;
%loads Xtr and Xte training and testing matrices

% mask is a binary sparse matrix of the query entries
mask = Xte>0;

delta = 1.5;

[E, P, vals, lagrange] = ...
    ratingconcentration(Xtr, mask, @sets_square5, delta);

%% pick some random ratings and show prediction

[I,J,V] = find(Xte);
figure(1);
for i = 1:4
    subplot(4,1,i);
    ind = randi(nnz(mask));
    title('True rating: %d', V(
end
